# 设备生成工具部署说明

## 📦 需要的文件和目录结构

```
设备生成工具/
├── generate_device.py          # 主程序
├── SunnyNet64.dll              # 抓包驱动
├── requirements.txt            # Python依赖
├── source/                     # 资源文件夹
│   └── tm13.12.2.apk          # 天猫APK
├── SunnyNet/                   # 抓包模块
│   ├── __init__.py
│   ├── CertManager.py
│   ├── Event.py
│   ├── HTTPClient.py
│   ├── Queue.py
│   ├── SunnyDLL.py
│   ├── SunnyNet.py
│   ├── TCPTools.py
│   ├── tools.py
│   ├── UDPTools.py
│   └── WebsocketTools.py
└── mumu/                       # MuMu模拟器控制模块
    ├── __init__.py
    ├── config.py
    ├── constant.py
    ├── control.py
    ├── mumu.py
    ├── utils.py
    └── api/
        ├── adb/
        │   └── Adb.py
        ├── core/
        │   ├── app.py
        │   ├── Core.py
        │   ├── Info.py
        │   ├── performance.py
        │   ├── power.py
        │   ├── shortcut.py
        │   ├── simulation.py
        │   └── window.py
        ├── develop/
        │   └── androidevent.py
        ├── driver/
        │   ├── bridge.py
        │   └── Driver.py
        ├── network/
        │   └── Network.py
        ├── permission/
        │   ├── Permission.py
        │   └── root.py
        ├── screen/
        │   ├── gui.py
        │   └── screen.py
        └── setting/
            └── setting.py
```

## 🔧 系统要求

1. **操作系统**：Windows 10/11 64位
2. **Python版本**：Python 3.8 或更高
3. **MuMu模拟器**：已安装 MuMu模拟器12（路径需配置）
4. **管理员权限**：必须以管理员身份运行

## 📝 安装步骤

### 1. 安装Python依赖

#### 方法1：使用国内镜像源（推荐，速度快）

```bash
# 使用清华镜像源
pip install -r requirements.txtpip install --upgrade pippip install --upgrade pip

# 或使用阿里云镜像源
pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/

# 或使用豆瓣镜像源
pip install -r requirements.txt -i https://pypi.douban.com/simple
```

#### 方法2：永久配置镜像源

```bash
# Windows系统
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple

# 然后正常安装
pip install -r requirements.txt
```

#### 方法3：直接安装（如果网络好）

```bash
pip install -r requirements.txt
```

**推荐使用方法1，速度最快！**

### 2. 配置MuMu模拟器路径

如果MuMu不在默认路径，需要修改 `mumu/mumu.py` 文件：

```python
# 修改这里的路径
__mumu_manager = r"D:\MuMuPlayer\nx_main\MuMuManager.exe"
```

常见路径：
- `D:\MuMuPlayer\nx_main\MuMuManager.exe`
- `D:\Program Files\Netease\MuMu\nx_main\MuMuManager.exe`

### 3. 准备APK文件

将天猫APK文件放到 `source` 目录下：
- 文件名：`tm13.12.2.apk`
- 路径：`source/tm13.12.2.apk`

## 🚀 使用方法

### 命令行参数

```bash
# 查看帮助
python generate_device.py -h

# 生成10个设备，使用1个窗口
python generate_device.py -n 10 -w 1

# 生成50个设备，使用3个并发窗口
python generate_device.py -n 50 -w 3

# 生成100个设备，使用5个并发窗口
python generate_device.py -n 100 -w 5

# 无限循环生成（不停止），使用2个窗口
python generate_device.py -w 2

# 默认方式（无限循环，1个窗口）
python generate_device.py
```

### 参数说明

- `-n, --num`：要生成的设备数量（默认0表示一直运行）
- `-w, --windows`：并发窗口数（默认1，范围1-10）

### 运行示例

```bash
# 以管理员身份运行PowerShell或CMD
python generate_device.py -n 100 -w 3
```

输出：
```
============================================================
🚀 设备参数批量生成工具
============================================================
📊 生成数量: 100 个
🪟 并发窗口: 3 个
============================================================

⏰ 任务开始时间: 2025-10-25 14:30:00
🌐 初始化共享抓包服务 (端口: 2025)...
✅ SunnyNet 共享服务已启动
🧹 正在清理所有现有的MuMu模拟器...
...
```

## 📊 输出结果

生成的设备参数会保存在：
- **文件名**：`设备.txt`
- **格式**：每行一个设备，字段用制表符分隔
- **字段**：`devid` `miniwua` `sgext` `umt` `utdid`

示例：
```
abc123...	def456...	ghi789...	jkl012...	mno345...
pqr678...	stu901...	vwx234...	yz5678...	abc901...
```

## ⚙️ 配置建议

### 并发窗口数建议

根据电脑配置选择：
- **低配置（4核8G）**：1-2个窗口
- **中配置（8核16G）**：3-4个窗口
- **高配置（16核32G+）**：5-10个窗口

### 性能优化

1. **关闭不必要的软件**：释放系统资源
2. **使用SSD硬盘**：提高模拟器启动速度
3. **保持网络畅通**：抓包需要网络请求
4. **定期清理**：删除旧的模拟器残留

## 🐛 常见问题

### 1. 提示"需要管理员权限"

**解决**：右键以管理员身份运行CMD或PowerShell

### 2. 找不到MuMuManager.exe

**解决**：检查并修改 `mumu/mumu.py` 中的路径

### 3. APK安装失败

**解决**：
- 检查APK文件是否存在于 `source/tm13.12.2.apk`
- 确认APK文件完整无损坏

### 4. 抓包一直失败

**解决**：
- 检查网络连接
- 确认防火墙允许程序运行
- 检查SunnyNet64.dll是否存在

### 5. 模拟器创建失败

**解决**：
- 检查MuMu模拟器是否正确安装
- 重启MuMu服务
- 手动删除残留模拟器

## 🔄 停止和重启

### 停止运行

按 `Ctrl+C` 可以安全停止程序，会自动清理所有模拟器和进程

### 重启运行

直接再次运行命令即可，程序会自动清理残留

## 📞 技术支持

如遇到问题，请检查：
1. 日志输出信息
2. `设备.txt` 文件内容
3. Windows事件查看器

## ⚠️ 注意事项

1. **必须以管理员身份运行**
2. **确保MuMu模拟器已正确安装**
3. **运行期间不要手动操作MuMu**
4. **建议在独立电脑上运行，避免影响其他工作**
5. **定期备份生成的设备参数文件**

