# ⚡ 淘宝直播刷量系统 - 快速部署指南

## 📦 新增文件列表

```
TBLive/
├── database_schema.sql          # 数据库表结构
├── api_server.py                # API服务端
├── ui_client.py                 # 刷量客户端UI（新）
├── import_data_to_db.py         # 数据导入工具
├── 启动_刷量客户端.bat          # 客户端启动脚本
├── 刷量客户端使用说明.md        # 详细使用说明
└── 快速部署指南.md              # 本文件
```

---

## 🚀 5 分钟快速部署

### 第一步：安装依赖（1 分钟）

```bash
pip install pymysql flask
```

### 第二步：配置数据库（2 分钟）

1. 创建数据库：

```sql
CREATE DATABASE tb_live DEFAULT CHARSET=utf8mb4;
```

2. 导入表结构：

```bash
mysql -u root -p tb_live < database_schema.sql
```

### 第三步：配置 API 服务器（1 分钟）

编辑 `api_server.py`，修改数据库密码：

```python
DB_CONFIG = {
    'host': 'localhost',
    'port': 3306,
    'user': 'root',
    'password': '改成你的数据库密码',  # ← 修改这里
    'database': 'tb_live',
    'charset': 'utf8mb4'
}
```

### 第四步：导入数据（1 分钟）

```bash
python import_data_to_db.py
```

按提示选择：

- 选项 3：导入全部数据
- Cookie 文件：账号.txt
- 设备文件：设备.txt
- 客户端 ID：1（给第一台电脑分配）

### 第五步：启动服务（10 秒）

**服务器端：**

```bash
python api_server.py
```

**客户端：**
双击 `启动_刷量客户端.bat`

---

## 🎯 客户端配置（30 秒）

### 1. 配置 API

1. 打开客户端，点击顶部 **"配置管理"**
2. 填写：
   - **API 地址**：`http://服务器IP:5000`（本机就填 `http://localhost:5000`）
   - **客户端密钥**：`client_key_001`
3. 点击 **"保存"**

### 2. 拉取数据

1. Cookie 管理 → 点击 **"远程拉取"**
2. 设备管理 → 点击 **"远程拉取"**

搞定！可以开始刷量了。

---

## 💼 多台电脑部署

### 服务器端（只需 1 台）

```bash
# 启动API服务
python api_server.py
```

### 客户端（10 台电脑）

每台电脑使用不同的密钥：

| 电脑   | 密钥             | 数据分配                           |
| ------ | ---------------- | ---------------------------------- |
| 电脑 1 | `client_key_001` | 前 100 个 Cookie + 前 100 个设备   |
| 电脑 2 | `client_key_002` | 101-200 个 Cookie + 101-200 个设备 |
| 电脑 3 | `client_key_003` | 201-300 个 Cookie + 201-300 个设备 |
| ...    | ...              | ...                                |

**分配数据命令：**

```bash
python import_data_to_db.py
# 选择 5. 分配数据给客户端
# 依次给10个客户端分配数据
```

---

## 📋 日常使用流程（工人操作）

### 简化版：3 步搞定

1. **粘贴淘口令** → 点击"解析"
2. **点击"获取操作前数据"**
3. **点击"开始刷量"**

等待完成，查看增量即可对账！

---

## 🔧 常见问题速查

### 问题 1：无法连接 API

**解决**：

- 检查 API 服务是否启动：`python api_server.py`
- 检查防火墙是否开放 5000 端口

### 问题 2：拉取不到数据

**解决**：

- 检查客户端密钥是否正确
- 检查数据库是否有分配数据：
  ```bash
  python import_data_to_db.py
  # 选择 5. 分配数据给客户端
  ```

### 问题 3：任务失败

**解决**：

- 检查 Cookie 是否失效（重新拉取）
- 检查设备参数是否失效（重新拉取）
- 检查网络连接

---

## 📊 数据管理速查

### 查看统计

```bash
python import_data_to_db.py
# 选择 4. 查看数据统计
```

### 导入新数据

```bash
python import_data_to_db.py
# 选择 3. 导入全部
```

### 重新分配数据

```bash
python import_data_to_db.py
# 选择 5. 分配数据给客户端
```

### SQL 快速分配

```sql
-- 给电脑1分配100个Cookie和100个设备
UPDATE tb_cookies SET client_id = 1 WHERE id <= 100;
UPDATE tb_devices SET client_id = 1 WHERE id <= 100;

-- 给电脑2分配
UPDATE tb_cookies SET client_id = 2 WHERE id > 100 AND id <= 200;
UPDATE tb_devices SET client_id = 2 WHERE id > 100 AND id <= 200;
```

---

## 🎉 完成！

现在你有：

✅ 一个 API 服务器（管理所有数据）  
✅ 10 个客户端（每个独立运行）  
✅ 简单易用的界面（工人傻瓜式操作）  
✅ 完整的数据统计（方便对账）

---

## 📞 技术架构

```
┌─────────────────────────────────────────────┐
│           MySQL数据库 (tb_live)              │
│  - tb_clients (客户端配置)                   │
│  - tb_cookies (Cookie账号)                  │
│  - tb_devices (设备参数)                     │
│  - tb_task_logs (任务记录)                  │
└──────────────────┬──────────────────────────┘
                   │
                   ↓
┌─────────────────────────────────────────────┐
│       API服务器 (api_server.py)              │
│  - 端口: 5000                                │
│  - 鉴权: client_key                          │
│  - 接口: /api/fetch_cookies                  │
│          /api/fetch_devices                  │
└──────────────────┬──────────────────────────┘
                   │
        ┌──────────┴──────────┬───────────┐
        │                     │           │
        ↓                     ↓           ↓
┌──────────────┐      ┌──────────────┐   ...
│  客户端1      │      │  客户端2      │
│ client_key_  │      │ client_key_  │
│ 001          │      │ 002          │
└──────────────┘      └──────────────┘
```

---

**版本**: v1.0  
**文档日期**: 2025-11-01  
**保持原有 to_requests.py 逻辑不变，只是换了个更简单的 UI**

